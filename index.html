<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body {
        font-family: Arial, sans-serif;
    }
    h1 {
        text-align: center;
    }
    .command-box {
        border: 2px solid #000;
        background-color: #000;
        padding: 10px;
        margin: 10px;
        position: relative;
        transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
        border-radius: 10px;
        max-width: 90%;
        box-sizing: border-box;
    }
    .command-box:hover {
        transform: scale(1.02);
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        background-color: rgba(0, 0, 0, 0.8);
    }
    .command-box:hover::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: 2px solid red;
        border-radius: 10px;
        animation: pulse 1s infinite;
        pointer-events: none;
    }
    .command-title {
        font-weight: bold;
        color: #fff;
    }
    .tooltip {
        display: none;
        position: absolute;
        background: #fff;
        color: #000;
        padding: 10px;
        border-radius: 10px;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        z-index: 1; /* Asegura que la descripción esté por encima de otros elementos */
        white-space: normal;
        width: 100%;
        box-sizing: border-box;
    }
    .command-box:hover .tooltip {
        display: block;
        top: 100%;
        margin-top: 10px;
    }
    @keyframes pulse {
        0% {
            box-shadow: 0 0 10px red;
        }
        50% {
            box-shadow: 0 0 20px red;
        }
        100% {
            box-shadow: 0 0 10px red;
        }
    }
</style>
<title>Paso a paso montar y desplegar el servicio DSpace con su base de datos</title>
</head>
<body>
    <h2>ESTUDIANTES:</h2>
    <p>Geison Sneider Peñaloza Mendoza</p>
    <p>Tein Eduardo Bustos Cruz</p>
    <p>Juan Carlos</p>
    <p>Omar Esneyder</p>
    <hr>
    <h2>Configuración de la base de datos</h2>
    <hr>
    
<h3>1. Actualizar paquetes</h3>
    <div class="command-box">
        <p class="command-title">sudo apt update && sudo apt upgrade -y</p>
        <div class="tooltip"><b>`sudo apt update`</b>: Actualiza la lista de paquetes disponibles y sus versiones<br><b>`sudo apt upgrade -y`</b>: Instala las versiones más recientes de todos los paquetes instalados en el sistema</div>
    </div>
    <h3>2. Instalar PostgreSQL</h3>
    <div class="command-box">
        <p class="command-title">sudo apt-get install postgresql postgresql-contrib libpostgresql-jdbc-java -y</p>
        <div class="tooltip"><b>`sudo apt-get install postgresql postgresql-contrib libpostgresql-jdbc-java -y`</b>: Instala PostgreSQL, herramientas adicionales y el controlador JDBC y PostgreSQL</div>
    </div>
    <h3>3. Configurar PostgreSQL para permitir conexiones remotas</h3>
    <div class="command-box">
        <p class="command-title">sudo nano /etc/postgresql/14/main/pg_hba.conf</p>
        <div class="tooltip">Editar el archivo <b>`pg_hba.conf`</b><br><b>`sudo nano /etc/postgresql/14/main/pg_hba.conf`</b>: Abre el archivo de configuración de autenticación de PostgreSQL<br><br>Añadir:<br><b>host dspace dspace <IP_YOUR_SERVER>/32 md5</IP_YOUR_SERVER></b><br><b>`host dspace dspace <IP_YOUR_SERVER>/32 md5`</b>: Permite conexiones del usuario <b>`dspace`</b> desde la dirección IP del servidor de aplicaciones usando autenticación <b>`md5`</b>.</div>
    </div>
    <h4>3.1 Permitir conexiones en el archivo `postgresql.conf`</h4>
    <div class="command-box">
        <p class="command-title">sudo nano /etc/postgresql/14/main/postgresql.conf</p>
        <div class="tooltip"><b>`sudo nano /etc/postgresql/14/main/postgresql.conf`</b>: Abre el archivo de configuración principal de PostgreSQL<br> Descomentar y ajustar: <b>listen_addresses = '*'</b><br><br><b>listen_addresses = '*'</b>: Permite que PostgreSQL escuche en todas las direcciones IP</div>
    </div>
    <h4>3.2 Reiniciar PostgreSQL</h4>
    <div class="command-box">
        <p class="command-title">sudo systemctl restart postgresql</p>
        <div class="tooltip"><b>`sudo systemctl restart postgresql`</b>: Reinicia el servicio de PostgreSQL para aplicar los cambios</div>
    </div>

    <hr>
    <h2>Instalación y configuración de DSpace</h2>
    <hr>
    
    <h3>4. Instalar Java</h3>
    <div class="command-box">
        <p class="command-title">sudo apt-get install openjdk-11-jdk</p>
        <div class="tooltip"><b>`sudo apt-get install openjdk-11-jdk`</b>: Instala OpenJDK 11, que es necesario para ejecutar DSpace</div>
    </div>
    <h3>5. Instalar Maven</h3>
    <div class="command-box">
        <p class="command-title">sudo apt-get install maven</p>
        <div class="tooltip"><b>`sudo apt-get install maven`</b>: Instala Maven, una herramienta de gestión y comprensión de proyectos utilizada por DSpace</div>
    </div>
    <h3>6. Descargar y descomprimir DSpace</h3>
    <div class="command-box">
        <p class="command-title">wget https://github.com/DSpace/DSpace/releases/download/dspace-6.3/dspace-6.3-release.zip</p>
        <div class="tooltip"><b>`wget https://github.com/DSpace/DSpace/releases/download/dspace-6.3/dspace-6.3-release.zip`</b>: Descarga la versión 6.3 de DSpace</div>
    </div>
    <div class="command-box">
        <p class="command-title">unzip dspace-6.3-release.zip</p>
        <div class="tooltip"><b>`unzip dspace-6.3-release.zip`</b>: Descomprime el archivo descargado</div>
    </div>
    <h3>7. Construir DSpace con Maven</h3>
    <div class="command-box">
        <p class="command-title">cd dspace-6.3-release</p>
        <div class="tooltip"><b>`cd dspace-6.3-release`</b>: Navega al directorio descomprimido de DSpace</div>
    </div>
    <div class="command-box">
        <p class="command-title">mvn package</p>
        <div class="tooltip"><b>`mvn package`</b>: Construye el paquete de DSpace usando Maven</div>
    </div>
    <h3>8. Crear la base de datos de DSpace en PostgreSQL</h3>
    <div class="command-box">
        <p class="command-title">sudo -u postgres createuser --username=postgres --no-superuser --pwprompt dspace</p>
        <div class="tooltip"><b>`sudo -u postgres createuser --username=postgres --no-superuser --pwprompt dspace`</b>: Crea un nuevo usuario de PostgreSQL llamado <b>`dspace`</b> sin permisos de superusuario y con una contraseña solicitada</div>
    </div>
    <div class="command-box">
        <p class="command-title">sudo -u postgres createdb --username=postgres --owner=dspace --encoding=UNICODE dspace</p>
        <div class="tooltip"><b>`sudo -u postgres createdb --username=postgres --owner=dspace --encoding=UNICODE dspace`</b>: Crea una nueva base de datos llamada <b>`dspace`</b> con el propietario <b>`dspace`</b> y codificación <b>UNICODE</b></div>
    </div>
    <h3>9. Configurar DSpace</h3>
    <div class="command-box">
        <p class="command-title">cd dspace/target/dspace-installer</p>
        <div class="tooltip"><b>`cd dspace/target/dspace-installer`</b>: Navega al directorio del instalador de DSpace</div>
    </div>
    <div class="command-box">
        <p class="command-title">ant fresh_install</p>
        <div class="tooltip"><b>`ant fresh_install`</b>: Realiza una instalación fresca de DSpace</div>
    </div>
    <h3>10. Configurar Tomcat</h3>
    <div class="command-box">
        <p class="command-title">sudo apt-get install tomcat9</p>
        <div class="tooltip"><b>`sudo apt-get install tomcat9`</b>: Instala el servidor de aplicaciones Tomcat 9</div>
    </div>
    <div class="command-box">
        <p class="command-title">sudo cp -r /dspace/webapps/* /var/lib/tomcat9/webapps/</p>
        <div class="tooltip"><b>`sudo cp -r /dspace/webapps/* /var/lib/tomcat9/webapps/`</b>: Copia las aplicaciones web de DSpace al directorio de aplicaciones web de Tomcat</div>
    </div>
    <h3>11. Reiniciar Tomcat</h3>
    <div class="command-box">
        <p class="command-title">sudo systemctl restart tomcat9</p>
        <div class="tooltip"><b>`sudo systemctl restart tomcat9`</b>: Reinicia el servicio de Tomcat para aplicar los cambios</div>
    </div>
</body>
</html>
